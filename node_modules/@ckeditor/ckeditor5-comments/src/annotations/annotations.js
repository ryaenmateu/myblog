/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x352e=['from','annotations-register-invalid-interface:\x20UI\x20plugin\x20must\x20implement\x20#attach\x20and\x20#detach\x20methods.','annotations-register-already-registered:\x20UI\x20of\x20a\x20given\x20name\x20already\x20registered.','refresh','resize','get','getIndex','function','activeView','set','Annotations','left','items','focusTracker','addEventListener','destroy','getTarget','change:isFocused','annotations-invalid-target:\x20Invalid\x20target.','element','remove','cancel','map','init','getAnnotationView','locale','targetRect','pluginName','switchTo','max','add','fire','selectedViews','change:activeView','_throttledOrderUpdate','length','removeEventListener','detach','uiType','render','isActive','top','has','sort','delete'];(function(_0x2a8781,_0x352eaf){const _0xabf57f=function(_0x42d7f4){while(--_0x42d7f4){_0x2a8781['push'](_0x2a8781['shift']());}};_0xabf57f(++_0x352eaf);}(_0x352e,0x116));const _0xabf5=function(_0x2a8781,_0x352eaf){_0x2a8781=_0x2a8781-0x0;let _0xabf57f=_0x352e[_0x2a8781];return _0xabf57f;};import _0x1d9f4f from'@ckeditor/ckeditor5-core/src/contextplugin';import _0x8e5f57 from'../annotations/view/annotationview';import _0x3855ef from'@ckeditor/ckeditor5-utils/src/collection';import _0x354d79 from'@ckeditor/ckeditor5-utils/src/focustracker';import _0x4cbee6 from'@ckeditor/ckeditor5-utils/src/dom/rect';import _0x51c5bb from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{throttle as _0xe303db,isElement as _0x1d3354}from'lodash-es';import'../../theme/annotation.css';export default class c extends _0x1d9f4f{static get[_0xabf5('0x13')](){return _0xabf5('0x2');}constructor(_0x105f4f){super(_0x105f4f),this[_0xabf5('0x4')]=new _0x3855ef(),this[_0xabf5('0x1')](_0xabf5('0x18'),[]),this[_0xabf5('0x1')](_0xabf5('0x0'),null),this['on'](_0xabf5('0x19'),(_0x5e6797,_0x3a5f22,_0x1c9126,_0x47f860)=>{_0x1c9126&&(this['i']['get'](_0x1c9126)[_0xabf5('0x20')]=!0x0);const _0x4b1757=this['i'][_0xabf5('0x2a')](_0x47f860);_0x47f860&&_0x4b1757&&(_0x4b1757['isActive']=!0x1);}),this[_0xabf5('0x5')]=new _0x354d79(),this[_0xabf5('0x5')]['on'](_0xabf5('0x9'),(_0xc52cb3,_0x152982,_0x323aa6)=>{_0x323aa6||(this[_0xabf5('0x0')]=null);}),this[_0xabf5('0x1e')]='',this['s']=new Map(),this['i']=new Map(),this['o']=new Map(),this['_throttledOrderUpdate']=_0xe303db(()=>{this['h'](),this['u']();},0x190,{'leading':!0x1});}[_0xabf5('0xf')](){window[_0xabf5('0x6')](_0xabf5('0x29'),this[_0xabf5('0x1a')]);}['register'](_0x2a40a3,_0x290325){if(this['s'][_0xabf5('0x22')](_0x2a40a3))throw new _0x51c5bb(_0xabf5('0x27'));if(_0xabf5('0x2c')!=typeof _0x290325['attach']||_0xabf5('0x2c')!=typeof _0x290325[_0xabf5('0x1d')])throw new _0x51c5bb(_0xabf5('0x26'));this['s']['set'](_0x2a40a3,_0x290325);}[_0xabf5('0x14')](_0x2aad01){if(!this['s'][_0xabf5('0x22')](_0x2aad01))throw new _0x51c5bb('annotations-switchto-missing-ui:\x20UI\x20of\x20a\x20given\x20name\x20has\x20been\x20not\x20registered.',this);this[_0xabf5('0x1e')]!==_0x2aad01&&(this[_0xabf5('0x1e')]&&this['s'][_0xabf5('0x2a')](this[_0xabf5('0x1e')])[_0xabf5('0x1d')](),this[_0xabf5('0x1e')]=_0x2aad01,this['s'][_0xabf5('0x2a')](this[_0xabf5('0x1e')])['attach']());}[_0xabf5('0x16')](_0x1e35df,_0x2425ce){if(this['i'][_0xabf5('0x22')](_0x1e35df))throw new _0x51c5bb('annotations-duplicated-item:\x20Given\x20view\x20was\x20already\x20added\x20to\x20the\x20annotations\x20repository.',this);const _0x232faf=new _0x8e5f57(this['context'][_0xabf5('0x11')],_0x1e35df);_0x232faf[_0xabf5('0x1f')](),this[_0xabf5('0x5')][_0xabf5('0x16')](_0x232faf[_0xabf5('0xb')]),_0x232faf['focusTracker']['on']('change:isFocused',(_0x1f65cb,_0x5d5e0d,_0x7b6423)=>{_0x7b6423&&(this[_0xabf5('0x0')]=_0x1e35df);}),this['o']['set'](_0x1e35df,_0x2425ce),this['l'](_0x232faf);const _0x3d4231=this['m'](_0x232faf[_0xabf5('0x12')]);return this[_0xabf5('0x4')][_0xabf5('0x16')](_0x232faf,_0x3d4231),this['i'][_0xabf5('0x1')](_0x1e35df,_0x232faf),_0x232faf;}[_0xabf5('0xc')](_0x361e57){if(!this['i']['has'](_0x361e57))return;const _0x116689=this['i'][_0xabf5('0x2a')](_0x361e57);this[_0xabf5('0x5')][_0xabf5('0xc')](_0x116689[_0xabf5('0xb')]),this[_0xabf5('0x0')]===_0x361e57&&(this[_0xabf5('0x0')]=null),this[_0xabf5('0x4')][_0xabf5('0xc')](_0x116689),_0x116689['destroy'](),this['o']['delete'](_0x361e57),this['i'][_0xabf5('0x24')](_0x361e57);}['getTarget'](_0xba92d3){const _0x1e30be=this['o'][_0xabf5('0x2a')](_0xba92d3);return _0xabf5('0x2c')==typeof _0x1e30be?_0x1e30be():_0x1e30be;}[_0xabf5('0x10')](_0x23106c){return this['i'][_0xabf5('0x2a')](_0x23106c);}['refresh'](){this[_0xabf5('0x17')](_0xabf5('0x28')),this[_0xabf5('0x1a')]();}[_0xabf5('0x7')](){super[_0xabf5('0x7')](),window[_0xabf5('0x1c')](_0xabf5('0x29'),this[_0xabf5('0x1a')]),this[_0xabf5('0x1a')][_0xabf5('0xd')](),this[_0xabf5('0x4')][_0xabf5('0xe')](_0x9bdcd6=>_0x9bdcd6[_0xabf5('0x7')]());}['h'](){for(const _0x35bf66 of this[_0xabf5('0x4')])this['l'](_0x35bf66);}['l'](_0x58cc50){const _0x2718df=this[_0xabf5('0x8')](_0x58cc50['customView']);if(!(_0x2718df instanceof _0x4cbee6||_0x1d3354(_0x2718df)))throw new _0x51c5bb(_0xabf5('0xa'));_0x58cc50['targetRect']=new _0x4cbee6(_0x2718df);}['u'](){const _0x17346d=Array[_0xabf5('0x25')](this[_0xabf5('0x4')])[_0xabf5('0x23')]((_0x58134e,_0x5073ce)=>d(_0x58134e[_0xabf5('0x12')],_0x5073ce[_0xabf5('0x12')]));for(let _0x186853=_0x17346d[_0xabf5('0x1b')]-0x1;_0x186853>0x0;_0x186853--){const _0x360749=_0x17346d[_0x186853];_0x186853!==this[_0xabf5('0x4')][_0xabf5('0x2b')](_0x360749)&&(this[_0xabf5('0x4')][_0xabf5('0xc')](_0x360749),this[_0xabf5('0x4')]['add'](_0x360749,_0x186853));}}['m'](_0x14f0c9){let _0x364bb2=0x0;for(const _0x157de8 of this['items']){const _0x3bcdd8=this[_0xabf5('0x8')](_0x157de8['customView']);if(d(_0x14f0c9,new _0x4cbee6(_0x3bcdd8))<0x0)return _0x364bb2;_0x364bb2++;}return Math[_0xabf5('0x15')](0x0,_0x364bb2);}}function d(_0x1d1381,_0x32d55e){const _0x107ac4=_0x1d1381[_0xabf5('0x21')]-_0x32d55e[_0xabf5('0x21')];return 0x0==_0x107ac4?_0x1d1381[_0xabf5('0x3')]-_0x32d55e[_0xabf5('0x3')]:_0x107ac4;}