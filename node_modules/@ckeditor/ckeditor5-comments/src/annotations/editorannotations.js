/*
 *             Copyright (c) 2016 - 2020, CKSource - Frederico Knabben. All rights reserved.
 *
 *
 *
 *
 *          +---------------------------------------------------------------------------------+
 *          |                                                                                 |
 *          |                                 Hello stranger!                                 |
 *          |                                                                                 |
 *          |                                                                                 |
 *          |   What you're currently looking at is the source code of a legally protected,   |
 *          |    proprietary software. Any attempts to deobfuscate / disassemble this code    |
 *          |               are forbidden and will result in legal consequences.              |
 *          |                                                                                 |
 *          |                                                                                 |
 *          +---------------------------------------------------------------------------------+
 *
 *
 *
 *
 */
const _0x5a1a=['selectedViews','high','refreshSelectedViews','plugins','sort','delete','view','remove','get','keys','change:range','cancel','set','customView','selection','from','focusTracker','refresh','init','getRanges','editing','element','isReadOnly','editorannotations-invalid-source-callback:\x20Function\x20required.','activeView','model','hasDomSelection','listenTo','add','directChange','requires','update','items','map','EditorAnnotations','document','editor','change:isFocused','containsRange','Annotations'];(function(_0x59f4fb,_0x5a1a03){const _0x39e16e=function(_0x33abba){while(--_0x33abba){_0x59f4fb['push'](_0x59f4fb['shift']());}};_0x39e16e(++_0x5a1a03);}(_0x5a1a,0x7b));const _0x39e1=function(_0x59f4fb,_0x5a1a03){_0x59f4fb=_0x59f4fb-0x0;let _0x39e16e=_0x5a1a[_0x59f4fb];return _0x39e16e;};import _0x3ae0ae from'@ckeditor/ckeditor5-core/src/plugin';import _0x1005cb from'./annotations';import _0x59e400 from'./inlineannotations';import _0x6f7774 from'@ckeditor/ckeditor5-utils/src/ckeditorerror';import{debounce as _0x5de5ce}from'lodash-es';export default class p extends _0x3ae0ae{static get[_0x39e1('0x1b')](){return[_0x1005cb,_0x59e400];}static get['pluginName'](){return _0x39e1('0x1f');}constructor(_0x45a13d){super(_0x45a13d),this['p']=new Set();}[_0x39e1('0xf')](){const _0x2599fe=this['editor'],_0x3ddc71=_0x2599fe[_0x39e1('0x0')][_0x39e1('0x5')](_0x39e1('0x24')),_0x56c799=_0x2599fe[_0x39e1('0x16')]['document'][_0x39e1('0xb')],_0x2e4e6e=_0x5de5ce(()=>this['refreshSelectedViews'](),0xa);_0x56c799['on'](_0x39e1('0x7'),(_0x40c1ff,_0xe27195)=>{_0xe27195[_0x39e1('0x1a')]&&(_0x2e4e6e[_0x39e1('0x8')](),this[_0x39e1('0x27')]());}),this['listenTo'](_0x2599fe[_0x39e1('0x11')][_0x39e1('0x3')][_0x39e1('0x20')],_0x39e1('0x22'),(_0x57989b,_0x4527bb,_0x119639)=>{_0x119639&&_0x2e4e6e();}),this[_0x39e1('0x18')](_0x2599fe['ui']['focusTracker'],_0x39e1('0x22'),(_0x4df720,_0x5a3058,_0x7ebd0d)=>{_0x7ebd0d||_0x2599fe[_0x39e1('0x13')]||this['g']['has'](_0x3ddc71['activeView'])&&(_0x3ddc71['activeView']=null);}),_0x3ddc71['focusTracker']['on'](_0x39e1('0x22'),(_0x38ff91,_0x3d3b1c,_0x38b2d8)=>{!_0x38b2d8&&_0x2599fe[_0x39e1('0x11')][_0x39e1('0x3')][_0x39e1('0x17')]&&(_0x2e4e6e['cancel'](),this[_0x39e1('0x27')](),_0x38ff91['stop']());},{'priority':_0x39e1('0x26')}),this['listenTo'](this[_0x39e1('0x21')]['ui'],_0x39e1('0x1c'),()=>_0x3ddc71[_0x39e1('0xe')]());const _0x1c3d83=new Set();this[_0x39e1('0x18')](_0x3ddc71[_0x39e1('0x1d')],'add',(_0x1fd0c3,_0x28e1c5)=>{for(const _0x1c9a47 of this['g'][_0x39e1('0x6')]())if(_0x1c9a47===_0x28e1c5[_0x39e1('0xa')]){_0x2599fe['ui']['focusTracker'][_0x39e1('0x19')](_0x28e1c5[_0x39e1('0x12')]),_0x1c3d83['add'](_0x28e1c5);break;}}),this[_0x39e1('0x18')](_0x3ddc71[_0x39e1('0x1d')],'remove',(_0x3173d6,_0x41db50)=>{_0x1c3d83['has'](_0x41db50)&&(_0x2599fe['ui'][_0x39e1('0xd')][_0x39e1('0x4')](_0x41db50['element']),_0x1c3d83[_0x39e1('0x2')](_0x41db50));});}['addSourceCollector'](_0x46d245){if('function'!=typeof _0x46d245)throw new _0x6f7774(_0x39e1('0x14'));this['p'][_0x39e1('0x19')](_0x46d245);}['refreshSelectedViews'](){const _0xd04a80=this[_0x39e1('0x21')][_0x39e1('0x0')][_0x39e1('0x5')](_0x39e1('0x24'));_0xd04a80['selectedViews']=this['k'](),_0xd04a80[_0x39e1('0x15')]=_0xd04a80[_0x39e1('0x25')][0x0]||null;}get['g'](){const _0x52f7ee=new Map();for(const _0xb52b6a of Array[_0x39e1('0xc')](this['p']))for(const [_0x36301f,_0x4843b6]of _0xb52b6a())_0x52f7ee[_0x39e1('0x9')](_0x36301f,_0x4843b6);return _0x52f7ee;}['k'](){const _0x4e73e9=[],_0x2f85a6=this[_0x39e1('0x21')][_0x39e1('0x16')][_0x39e1('0x20')]['selection'],_0x445eb1=Array[_0x39e1('0xc')](_0x2f85a6[_0x39e1('0x10')]()),_0x12596d=this[_0x39e1('0x21')][_0x39e1('0x0')][_0x39e1('0x5')](_0x39e1('0x24'));for(const [_0x187b2e,_0x2d8014]of this['g']){const _0x1e738e=_0x3c2fd0(_0x2d8014);_0x1e738e&&_0x4e73e9['push']([_0x187b2e,_0x1e738e]);}function _0x3c2fd0(_0x1964b4){for(const _0x152df0 of _0x1964b4)for(const _0x3b4975 of _0x445eb1)if(_0x152df0[_0x39e1('0x23')](_0x3b4975,!_0x2f85a6['isCollapsed']))return _0x152df0;return null;}return _0x4e73e9[_0x39e1('0x1')]((_0x41468,_0x187721)=>{const _0x18affb=_0x41468[0x1],_0x1323f2=_0x187721[0x1];return _0x18affb[_0x39e1('0x23')](_0x1323f2)?0x1:_0x1323f2['containsRange'](_0x18affb)||_0x41468[0x0]==_0x12596d[_0x39e1('0x15')]?-0x1:_0x187721[0x0]==_0x12596d['activeView']?0x1:0x0;})[_0x39e1('0x1e')](_0x1a5b77=>_0x1a5b77[0x0]);}}